From b5732601a7ff5457cb1e3a9389761aa23a81f54d Mon Sep 17 00:00:00 2001
From: Linus Walleij <linusw@kernel.org>
Date: Sun, 1 Feb 2026 10:20:56 +0100
Subject: [PATCH] gemini: augment SL93512R DTS with botched partitions

Same botched partitions as the Raidsonic IB-4220-B.

Signed-off-by: Linus Walleij <linusw@kernel.org>
---
 arch/arm/boot/dts/gemini/gemini-sl93512r.dts | 39 ++++++++++++++++++--
 1 file changed, 35 insertions(+), 4 deletions(-)

--- a/arch/arm/boot/dts/gemini/gemini-sl93512r.dts
+++ b/arch/arm/boot/dts/gemini/gemini-sl93512r.dts
@@ -24,7 +24,7 @@
 	};
 
 	chosen {
-		bootargs = "console=ttyS0,19200n8 root=/dev/mtdblock3 rw rootfstype=squashfs,jffs2 rootwait";
+		bootargs = "console=ttyS0,19200n8";
 		stdout-path = &uart0;
 	};
 
@@ -143,10 +143,41 @@
 			/* 16MB of flash */
 			reg = <0x30000000 0x01000000>;
 
+			/*
+			 * Override the RedBoot partition table with fixed partitions
+			 * in order to create a coherent "firmware" partition so that
+			 * we can have optimal flash usage with OpenWrt in a big
+			 * MTD-splitted "firmware" partition.
+			 */
 			partitions {
-				compatible = "redboot-fis";
-				/* Eraseblock at 0xfe0000 */
-				fis-index-block = <0x7f>;
+				compatible = "fixed-partitions";
+				#address-cells = <1>;
+				#size-cells = <1>;
+				partition@0 {
+					label = "BOOT";
+					reg = <0x00000000 0x00020000>;
+					read-only;
+				};
+				partition@1 {
+					compatible = "openwrt,executable-prolog";
+					label = "firmware";
+					reg = <0x00020000 0x00f00000>;
+				};
+				partition@2 {
+					label = "VCTL";
+					reg = <0x00f20000 0x00020000>;
+					read-only;
+				};
+				partition@3 {
+					label = "CurConf";
+					reg = <0x00f40000 0x000a0000>;
+					read-only;
+				};
+				partition@4 {
+					label = "FIS directory";
+					reg = <0x00fe0000 0x00020000>;
+					read-only;
+				};
 			};
 		};
 
