<%+header%>

<h2>Secondsystem - 系统状态</h2>

<div class="cbi-section">
    <h3>系统基本信息</h3>
    <div class="cbi-valuebox">
        <div class="cbi-value">
            <label class="cbi-value-title">当前运行系统</label>
            <div class="cbi-value-field"><%= luci.sys.exec("uci get Secondsystem.config.current_system 2>/dev/null || echo '未知'") %></div>
        </div>
        
        <div class="cbi-value">
            <label class="cbi-value-title">系统版本</label>
            <div class="cbi-value-field"><%= luci.sys.exec("cat /etc/secondsystem_version 2>/dev/null || echo '未知'") %></div>
        </div>
        
        <div class="cbi-value">
            <label class="cbi-value-title">启动时间</label>
            <div class="cbi-value-field"><%= luci.sys.exec("uptime -p | sed 's/up //' 2>/dev/null || echo '未知'") %></div>
        </div>
        
        <div class="cbi-value">
            <label class="cbi-value-title">最后切换时间</label>
            <div class="cbi-value-field"><%= luci.sys.exec("uci get Secondsystem.config.last_switch 2>/dev/null || echo '从未切换'") %></div>
        </div>
    </div>
</div>

<div class="cbi-section">
    <h3>系统状态指标</h3>
    <div class="cbi-valuebox">
        <div class="cbi-value">
            <label class="cbi-value-title">系统负载</label>
            <div class="cbi-value-field"><%= luci.sys.exec("uptime | awk -F 'load average: ' '{print $2}' 2>/dev/null || echo '未知'") %></div>
        </div>
        
        <div class="cbi-value">
            <label class="cbi-value-title">内存使用</label>
            <div class="cbi-value-field"><%= luci.sys.exec("free -h | awk '/Mem:/ {print $3\"/\"$2}' 2>/dev/null || echo '未知'") %></div>
        </div>
        
        <div class="cbi-value">
            <label class="cbi-value-title">存储使用</label>
            <div class="cbi-value-field"><%= luci.sys.exec("df -h / | awk 'NR==2 {print $3\"/\"$2}' 2>/dev/null || echo '未知'") %></div>
        </div>
    </div>
</div>

<div class="cbi-section">
    <h3>操作提示</h3>
    <ul class="cbi-list">
        <li>切换系统会重启设备并改变启动分区</li>
        <li>系统切换前请确保已保存重要配置</li>
        <li>若系统异常，可通过硬件按键方式恢复官方系统</li>
        <li>状态数据每5分钟自动刷新一次</li>
    </ul>
</div>

<div class="cbi-section">
    <div class="right">
        <input type="button" class="cbi-button cbi-button-reload" value="刷新状态" onclick="location.reload()">
    </div>
</div>

<%+footer%>
    
