name: Build lantiq target
# autogenerated file, see ./.github/workflows/scripts/create-target-files.py

on:
  pull_request:
    paths:
      - '.github/workflows/target-lantiq.yml'
      - 'target/linux/lantiq/**'
      - 'package/kernel/lantiq/**'
      - 'package/firmware/lantiq/**'
      - 'package/boot/uboot-lantiq/**'
  push:
    paths:
      - '.github/workflows/target-lantiq.yml'
      - 'target/linux/lantiq/**'
      - 'package/kernel/lantiq/**'
      - 'package/firmware/lantiq/**'
      - 'package/boot/uboot-lantiq/**'

permissions:
  contents: read

jobs:
  build_ext:
    permissions:
      contents: read
      packages: read
    strategy:
      fail-fast: False
      matrix:
        subtarget: [ase, xrx200, xway, xway_legacy]
        testing: [false, true]
    uses: ./.github/workflows/build.yml
    with:
      target: "lantiq/${{ matrix.subtarget }}"
      testing: ${{ matrix.testing }}
      build_kernel: true
      build_full: true
      build_all_boards: true

  build_int:
    permissions:
      contents: read
      packages: read
    strategy:
      fail-fast: False
      matrix:
        subtarget: [falcon]
        testing: [false, true]
    uses: ./.github/workflows/build.yml
    with:
      target: "lantiq/${{ matrix.subtarget }}"
      testing: ${{ matrix.testing }}
      build_toolchain: true
      build_kernel: true
      build_full: true
      build_all_boards: true


  check-kernel-patches:
    permissions:
      contents: read
      packages: read
    strategy:
      fail-fast: False
      matrix:
        subtarget: [ase]
        testing: [false, true]
    uses: ./.github/workflows/check-kernel-patches.yml
    with:
      target: "lantiq/${{ matrix.subtarget }}"
      testing: ${{ matrix.testing }}
