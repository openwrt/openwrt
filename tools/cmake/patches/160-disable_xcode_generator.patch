--- a/Source/CMakeLists.txt
+++ b/Source/CMakeLists.txt
@@ -886,7 +886,7 @@ if(CMake_USE_XCOFF_PARSER)
 endif()
 
 # Xcode only works on Apple
-if(APPLE)
+if(APPLE_DISABLED)
   target_sources(
     CMakeLib
     PRIVATE
--- a/Source/cmake.cxx
+++ b/Source/cmake.cxx
@@ -138,7 +138,7 @@
 #  endif
 #endif
 
-#if defined(__APPLE__)
+#if defined(__APPLE_DISABLED__)
 #  if !defined(CMAKE_BOOTSTRAP)
 #    include "cmGlobalXCodeGenerator.h"
 
